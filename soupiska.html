<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soupiska A-T√Ωm | SK Kostelec nad ƒåern√Ωmi lesy</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="soupiska.css">
</head>
<body>

    <header>
        <nav class="navbar">
            <div class="logo-container">
                <img src="logo-sk-kostelec.png" alt="Logo SK Kostelec" class="main-logo">
            </div>
            <button class="menu-toggle" aria-label="Otev≈ô√≠t menu">
                <span></span><span></span><span></span>
            </button>
            <ul class="nav-links">
                <li><a href="index.html">Aktuality</a></li>
                <li><a href="soupiska.html">A-T√Ωm</a></li>
                <li><a href="klub.html">Klub</a></li>
                <li><a href="kontakt.html">Kontakt</a></li>
            </ul>
        </nav>
    </header>

    <div class="page-layout container">
        <aside class="sidebar-section">
            <h2 class="section-title">A-T√Ωm</h2>
            <div class="sidebar-box">
                <ul class="sidebar-nav">
                    <li><a href="soupiska.html" class="active">üèÉ Soupiska</a></li>
                    <li><a href="tabulka.html">üìä Tabulka</a></li>
                    <li><a href="zapasy.html">‚öΩ Z√°pasy</a></li>
                </ul>
            </div>
        </aside>
        
        <main class="club-content">
            <div id="roster-container">
                <p>Naƒç√≠t√°m soupisku...</p>
            </div>
        </main>
    </div>

    <section class="partners-section">
        <h3 class="partners-title">Na≈°i partne≈ôi</h3>
        <div class="partners-container">
            <a href="#"><img src="assets/images/sponsors/msmt.png" alt="M≈†MT"></a>
            <a href="#"><img src="assets/images/sponsors/NSA.png" alt="NSA"></a>
            <a href="#"><img src="assets/images/sponsors/sportfotbal_logo.png" alt="SportFotbal"></a>
        </div>
    </section>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <img src="logo-sk-kostelec.png" alt="SK Kostelec" class="footer-logo">
                    <p>Tradiƒçn√≠ fotbalov√Ω klub zalo≈æen√Ω v roce 1921. Zakl√°d√°me si na v√Ωchovƒõ ml√°de≈æe a f√©rov√©m sportovn√≠m prost≈ôed√≠.</p>
                </div>
                <div class="footer-col">
                    <h4>Navigace</h4>
                    <ul>
                        <li><a href="index.html">Aktuality</a></li>
                        <li><a href="soupiska.html">A-T√Ωm</a></li>
                        <li><a href="klub.html">Klub</a></li>
                        <li><a href="kontakt.html">Kontakt</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Kontakt</h4>
                    <p>Sportovn√≠ 752, 281 63 Kostelec nad ƒåern√Ωmi lesy</p>
                    <p>Email: skkostelec@seznam.cz</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 SK Kostelec nad ƒåern√Ωmi lesy. V≈°echna pr√°va vyhrazena.</p>
            </div>
        </div>
    </footer>

    <button id="backToTop" title="Nahoru">‚Üë</button>

    <script>
        const menuToggle = document.querySelector('.menu-toggle');
        const navLinks = document.querySelector('.nav-links');
        if (menuToggle) {
            menuToggle.addEventListener('click', () => {
                menuToggle.classList.toggle('active');
                navLinks.classList.toggle('active');
                document.body.style.overflow = navLinks.classList.contains('active') ? 'hidden' : 'auto';
            });
        }

        // Seznam soubor≈Ø hr√°ƒç≈Ø - mus√≠ odpov√≠dat soubor≈Øm v _data/players/
        const LOCAL_PLAYERS = [
            'adam-fr≈Øhauf.json',
            'jaroslav-ka≈°e.json',
            'justin-crighton.json',
            'milan-klimt.json',
            'petr-pojezny.json',
            'vojta-hanzlik.json'
        ];

        const SECTION_MAP = {
            "Brank√°≈ô": "Brank√°≈ôi",
            "Obr√°nce": "Obr√°nci",
            "Z√°lo≈æn√≠k": "Z√°lo≈æn√≠ci",
            "√ötoƒçn√≠k": "√ötoƒçn√≠ci"
        };

        // Funkce pro vytvo≈ôen√≠ URL slugu (stejn√° jako na indexu a v hrac.html)
        function createSlug(text) {
            return text.toString().toLowerCase()
                .normalize('NFD')
                .replace(/[\u0300-\u036f]/g, '')
                .replace(/\s+/g, '-')
                .replace(/[^\w\-]+/g, '')
                .replace(/\-\-+/g, '-')
                .trim();
        }

        function calculateAge(birthday) {
            if (!birthday || birthday === "--") return "--";
            const parts = birthday.split('.');
            if (parts.length < 3) return "--";
            const bDate = new Date(parts[2], parts[1] - 1, parts[0]);
            const ageDifMs = Date.now() - bDate.getTime();
            const ageDate = new Date(ageDifMs);
            return Math.abs(ageDate.getUTCFullYear() - 1970) + " let";
        }

        async function loadRoster() {
            const container = document.getElementById('roster-container');
            const players = [];
            
            for (const name of LOCAL_PLAYERS) {
                try {
                    const r = await fetch(`./_data/players/${name}`);
                    if (r.ok) {
                        const playerData = await r.json();
                        players.push(playerData);
                    }
                } catch(e) { 
                    console.error("Chyba naƒç√≠t√°n√≠ hr√°ƒçe:", name); 
                }
            }

            const grouped = {};
            players.forEach(p => {
                const pos = p.position || "Obr√°nce";
                if (!grouped[pos]) grouped[pos] = [];
                grouped[pos].push(p);
            });

            container.innerHTML = '';
            
            // Proch√°z√≠me pozice podle SECTION_MAP pro spr√°vn√© po≈ôad√≠ (Gk -> Def -> Mid -> Atk)
            for (const [posKey, posName] of Object.entries(SECTION_MAP)) {
                if (grouped[posKey] && grouped[posKey].length > 0) {
                    let tableHtml = `
                        <div class="position-group">
                            <h2 class="main-title">${posName}</h2>
                            <div class="table-responsive">
                                <table class="roster-table">
                                    <thead>
                                        <tr>
                                            <th class="col-num-head">#</th>
                                            <th style="text-align:left">Jm√©no</th>
                                            <th class="mobile-hide">Narozen</th>
                                            <th class="mobile-hide">Vƒõk</th>
                                            <th class="mobile-hide">V√Ω≈°ka</th>
                                            <th class="mobile-hide">V√°ha</th>
                                        </tr>
                                    </thead>
                                    <tbody>`;
                    
                    // Se≈ôadit hr√°ƒçe podle ƒç√≠sla dresu
                    grouped[posKey].sort((a,b) => (a.number || 99) - (b.number || 99)).forEach(p => {
                        const slug = createSlug(p.title);
                        tableHtml += `
                            <tr>
                                <td class="col-num">${p.number || ''}</td>
                                <td style="text-align:left">
                                    <a href="hrac.html?player=${slug}" class="player-link">${p.title}</a>
                                </td>
                                <td class="mobile-hide">${p.born || '--'}</td>
                                <td class="mobile-hide">${calculateAge(p.born)}</td>
                                <td class="mobile-hide">${p.height ? p.height + ' cm' : '--'}</td>
                                <td class="mobile-hide">${p.weight ? p.weight + ' kg' : '--'}</td>
                            </tr>`;
                    });
                    
                    tableHtml += `</tbody></table></div></div>`;
                    container.innerHTML += tableHtml;
                }
            }
        }

        loadRoster();

        const btt = document.getElementById("backToTop");
        window.onscroll = function() {
            if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) { 
                btt.style.display = "block"; 
            } else { 
                btt.style.display = "none"; 
            }
        };
        btt.onclick = function() { window.scrollTo({ top: 0, behavior: 'smooth' }); };
    </script>
</body>
</html>