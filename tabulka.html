<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabulka A-T≈ô√≠da | SK Kostelec nad ƒåern√Ωmi lesy</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="tabulka.css">
</head>
<body>

    <header>
        <nav class="navbar">
            <div class="logo-container">
                <img src="logo-sk-kostelec.png" alt="Logo SK Kostelec" class="main-logo">
            </div>
            <button class="menu-toggle" aria-label="Otev≈ô√≠t menu">
                <span></span><span></span><span></span>
            </button>
            <ul class="nav-links">
                <li><a href="index.html">Aktuality</a></li>
                <li><a href="soupiska.html">A-T√Ωm</a></li>
                <li><a href="klub.html">Klub</a></li>
                <li><a href="kontakt.html">Kontakt</a></li>
            </ul>
        </nav>
    </header>

    <div class="page-layout container">
        <aside class="sidebar-section">
            <h2 class="section-title">A-T√Ωm</h2>
            <div class="sidebar-box">
                <ul class="sidebar-nav">
                    <li><a href="soupiska.html">üèÉ Soupiska</a></li>
                    <li><a href="tabulka.html" class="active">üìä Tabulka</a></li>
                    <li><a href="zapasy.html">‚öΩ Z√°pasy</a></li>
                </ul>
            </div>
        </aside>
        
        <main class="club-content">
            <h2 class="main-title">Tabulka A-T≈ô√≠da</h2>
            <div class="table-responsive">
                <table class="league-page-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th style="text-align:left">T√Ωm</th>
                            <th class="mobile-hide">Z</th>
                            <th class="mobile-hide">V</th>
                            <th class="mobile-hide">R</th>
                            <th class="mobile-hide">P</th>
                            <th class="mobile-hide">Sk√≥re</th>
                            <th class="mobile-hide">Rozd√≠l</th>
                            <th>B</th>
                        </tr>
                    </thead>
                    <tbody id="league-table-body">
                        <tr><td colspan="9">Poƒç√≠t√°m aktu√°ln√≠ tabulku...</td></tr>
                    </tbody>
                </table>
            </div>

            <div class="table-legend">
                <h3>Vysvƒõtlivky</h3>
                <div class="legend-grid">
                    <div class="legend-item"><strong>Z</strong> Poƒçet z√°pas≈Ø</div>
                    <div class="legend-item"><strong>V</strong> V√Ωhry</div>
                    <div class="legend-item"><strong>R</strong> Rem√≠zy</div>
                    <div class="legend-item"><strong>P</strong> Prohry</div>
                    <div class="legend-item"><strong>Sk√≥re</strong> Vst≈ôelen√© : Obdr≈æen√© g√≥ly</div>
                    <div class="legend-item"><strong>Rozd√≠l</strong> Rozd√≠l ve sk√≥re</div>
                    <div class="legend-item"><strong>B</strong> Celkov√Ω poƒçet bod≈Ø</div>
                </div>
            </div>
        </main>
    </div>

    <section class="partners-section">
        <h3 class="partners-title">Na≈°i partne≈ôi</h3>
        <div class="partners-container">
            <a href="#"><img src="assets/images/sponsors/msmt.png" alt="M≈†MT"></a>
            <a href="#"><img src="assets/images/sponsors/NSA.png" alt="NSA"></a>
            <a href="#"><img src="assets/images/sponsors/sportfotbal_logo.png" alt="SportFotbal"></a>
        </div>
    </section>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <img src="logo-sk-kostelec.png" alt="SK Kostelec" class="footer-logo">
                    <p>Tradiƒçn√≠ fotbalov√Ω klub zalo≈æen√Ω v roce 1921. Zakl√°d√°me si na v√Ωchovƒõ ml√°de≈æe a f√©rov√©m sportovn√≠m prost≈ôed√≠.</p>
                </div>
                <div class="footer-col">
                    <h4>Navigace</h4>
                    <ul>
                        <li><a href="index.html">Aktuality</a></li>
                        <li><a href="soupiska.html">A-T√Ωm</a></li>
                        <li><a href="klub.html">Klub</a></li>
                        <li><a href="kontakt.html">Kontakt</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Kontakt</h4>
                    <p>Sportovn√≠ 752, 281 63 Kostelec nad ƒåern√Ωmi lesy</p>
                    <p>Email: skkostelec@seznam.cz</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 SK Kostelec nad ƒåern√Ωmi lesy. V≈°echna pr√°va vyhrazena.</p>
            </div>
        </div>
    </footer>

    <button id="backToTop" title="Nahoru">‚Üë</button>

    <script>
        // Nastaven√≠ - seznam soubor≈Ø pro simulaci slo≈æek na lok√°lu
        const TEAM_FILES = ['kostelec.json', 'pacov.json', 'cestlice.json', 'lounovice.json', 'mukarov.json', 'svojetice.json', 'dobrejovice.json', 'krizky.json', 'ondrejov.json', 'kunice.json', 'mirosovice.json', 'mnichovice.json', 'kamenice.json', 'skalice.json'];
        const MATCH_FILES = ['match-2026-02-20.json', 'match-2026-02-21.json']; // Zde budou p≈ôib√Ωvat soubory z adminu

        async function init() {
            await generateLeagueTable();
        }

        async function generateLeagueTable() {
            const tableBody = document.getElementById('league-table-body');
            try {
                let stats = {};

                // 1. Naƒçten√≠ t√Ωm≈Ø
                for (const file of TEAM_FILES) {
                    const res = await fetch(`./_data/teams/${file}`);
                    if (res.ok) {
                        const t = await res.json();
                        stats[t.id] = { 
                            title: t.title, 
                            logo: t.logo, 
                            z: 0, v: 0, r: 0, p: 0, gf: 0, ga: 0, b: 0 
                        };
                    }
                }

                // 2. Naƒçten√≠ odehran√Ωch z√°pas≈Ø a v√Ωpoƒçet bod≈Ø
                for (const file of MATCH_FILES) {
                    const res = await fetch(`./_data/matches/${file}`);
                    if (res.ok) {
                        const m = await res.json();
                        // Poƒç√≠t√°me jen odehran√© z√°pasy s vyplnƒõn√Ωm sk√≥re
                        if (m.played && stats[m.home_id] && stats[m.away_id]) {
                            const h = stats[m.home_id];
                            const a = stats[m.away_id];

                            h.z++; a.z++;
                            h.gf += parseInt(m.home_score);
                            h.ga += parseInt(m.away_score);
                            a.gf += parseInt(m.away_score);
                            a.ga += parseInt(m.home_score);

                            if (parseInt(m.home_score) > parseInt(m.away_score)) {
                                h.v++; h.b += 3; a.p++;
                            } else if (parseInt(m.home_score) < parseInt(m.away_score)) {
                                a.v++; a.b += 3; h.p++;
                            } else {
                                h.r++; a.r++; h.b += 1; a.b += 1;
                            }
                        }
                    }
                }

                // 3. Se≈ôazen√≠ (body -> rozd√≠l sk√≥re -> vst≈ôelen√© g√≥ly)
                const sorted = Object.values(stats).sort((a, b) => {
                    if (b.b !== a.b) return b.b - a.b;
                    const diffA = a.gf - a.ga;
                    const diffB = b.gf - b.ga;
                    if (diffB !== diffA) return diffB - diffA;
                    return b.gf - a.gf;
                });

                // 4. Vykreslen√≠
                tableBody.innerHTML = sorted.map((row, i) => {
                    const diff = row.gf - row.ga;
                    const isKostelec = row.title.includes("SK Kostelec nad ƒåern√Ωmi lesy");
                    
                    return `
                        <tr class="${isKostelec ? 'highlight-me' : ''}">
                            <td class="col-rank">${i + 1}.</td>
                            <td style="text-align:left">
                                <div class="team-info" style="display:flex; align-items:center; gap:10px;">
                                    <img src="${row.logo}" alt="" class="team-logo" style="width:25px; height:25px; object-fit:contain;">
                                    <span class="team-name">${row.title}</span>
                                </div>
                            </td>
                            <td class="mobile-hide">${row.z}</td>
                            <td class="mobile-hide">${row.v}</td>
                            <td class="mobile-hide">${row.r}</td>
                            <td class="mobile-hide">${row.p}</td>
                            <td class="mobile-hide">${row.gf}:${row.ga}</td>
                            <td class="mobile-hide">${diff > 0 ? '+' + diff : diff}</td>
                            <td class="col-points" style="font-weight:bold; color:#0033ff;">${row.b}</td>
                        </tr>
                    `;
                }).join('');

            } catch (e) {
                console.error(e);
                tableBody.innerHTML = '<tr><td colspan="9">Chyba p≈ôi naƒç√≠t√°n√≠ dat.</td></tr>';
            }
        }

        init();

        // UI obsluha menu
        const menuToggle = document.querySelector('.menu-toggle');
        const navLinks = document.querySelector('.nav-links');
        if (menuToggle) {
            menuToggle.addEventListener('click', () => {
                menuToggle.classList.toggle('active');
                navLinks.classList.toggle('active');
            });
        }
        
        const btt = document.getElementById("backToTop");
        window.onscroll = function() {
            if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) { btt.style.display = "block"; } else { btt.style.display = "none"; }
        };
        btt.onclick = function() { window.scrollTo({ top: 0, behavior: 'smooth' }); };
    </script>
</body>
</html>