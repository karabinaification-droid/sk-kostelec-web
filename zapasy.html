<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Z√°pasy A-T√Ωm | SK Kostelec nad ƒåern√Ωmi lesy</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="zapasy.css">
</head>
<body>

    <header>
        <nav class="navbar">
            <div class="logo-container">
                <img src="logo-sk-kostelec.png" alt="Logo SK Kostelec" class="main-logo">
            </div>
            <button class="menu-toggle" aria-label="Otev≈ô√≠t menu">
                <span></span><span></span><span></span>
            </button>
            <ul class="nav-links">
                <li><a href="index.html">Aktuality</a></li>
                <li><a href="soupiska.html">A-T√Ωm</a></li>
                <li><a href="klub.html">Klub</a></li>
                <li><a href="kontakt.html">Kontakt</a></li>
            </ul>
        </nav>
    </header>

    <div class="page-layout container">
        <aside class="sidebar-section">
            <h2 class="section-title">A-T√Ωm</h2>
            <div class="sidebar-box">
                <ul class="sidebar-nav">
                    <li><a href="soupiska.html">üèÉ Soupiska</a></li>
                    <li><a href="tabulka.html">üìä Tabulka</a></li>
                    <li><a href="zapasy.html" class="active">‚öΩ Z√°pasy</a></li>
                </ul>
            </div>
        </aside>
        
        <main class="club-content">
            <h2 class="main-title">Z√°pasy SK Kostelec</h2>
            
            <div id="matches-container">
                <p>Naƒç√≠t√°m kompletn√≠ rozpis a v√Ωsledky...</p>
            </div>
        </main>
    </div>

    <section class="partners-section">
        <h3 class="partners-title">Na≈°i partne≈ôi</h3>
        <div class="partners-container">
            <a href="#"><img src="assets/images/sponsors/msmt.png" alt="M≈†MT"></a>
            <a href="#"><img src="assets/images/sponsors/NSA.png" alt="NSA"></a>
            <a href="#"><img src="assets/images/sponsors/sportfotbal_logo.png" alt="SportFotbal"></a>
        </div>
    </section>

    <footer class="main-footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <img src="logo-sk-kostelec.png" alt="SK Kostelec" class="footer-logo">
                    <p>Tradiƒçn√≠ fotbalov√Ω klub zalo≈æen√Ω v roce 1921. Zakl√°d√°me si na v√Ωchovƒõ ml√°de≈æe a f√©rov√©m sportovn√≠m prost≈ôed√≠.</p>
                </div>
                <div class="footer-col">
                    <h4>Navigace</h4>
                    <ul>
                        <li><a href="index.html">Aktuality</a></li>
                        <li><a href="soupiska.html">A-T√Ωm</a></li>
                        <li><a href="klub.html">Klub</a></li>
                        <li><a href="kontakt.html">Kontakt</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Kontakt</h4>
                    <p>Sportovn√≠ 752, 281 63 Kostelec nad ƒåern√Ωmi lesy</p>
                    <p>Email: skkostelec@seznam.cz</p>
                    <p>Tel: +420 739 488 133 (p≈ôedseda)</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 SK Kostelec nad ƒåern√Ωmi lesy. V≈°echna pr√°va vyhrazena.</p>
            </div>
        </div>
    </footer>

    <button id="backToTop" title="Nahoru">‚Üë</button>

    <script>
        const REPO = 'karabinaification-droid/sk-kostelec-web';
        const KOSTELEC_ID = 'kostelec';
        const IS_LOCAL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';

        async function getGitHubData(path) {
            try {
                const url = `https://api.github.com/repos/${REPO}/contents/${path}`;
                const res = await fetch(url);
                return res.ok ? await res.json() : [];
            } catch (e) { return []; }
        }

        async function fetchJSON(url) {
            try {
                const res = await fetch(url);
                return res.ok ? await res.json() : null;
            } catch (e) { return null; }
        }

        async function initMatches() {
            const container = document.getElementById('matches-container');
            
            try {
                // 1. NAƒåTEN√ç T√ùM≈Æ PRO MAPOV√ÅN√ç ID -> N√ÅZEV/LOGO
                const teamFiles = await getGitHubData('_data/teams');
                let teamsMap = {};
                for (let f of teamFiles) {
                    const t = await fetchJSON(IS_LOCAL ? `./_data/teams/${f.name}` : f.download_url);
                    if (t) teamsMap[t.id] = t;
                }

                // 2. NAƒåTEN√ç V≈†ECH Z√ÅPAS≈Æ
                const matchFiles = await getGitHubData('_data/matches');
                let allMatches = [];
                for (let f of matchFiles) {
                    const m = await fetchJSON(IS_LOCAL ? `./_data/matches/${f.name}` : f.download_url);
                    if (m) allMatches.push(m);
                }

                // 3. FILTRACE Z√ÅPAS≈Æ KOSTELCE A SE≈òAZEN√ç (OD NEJNOVƒöJ≈†√çHO)
                const kostelecMatches = allMatches
                    .filter(m => m.home_id === KOSTELEC_ID || m.away_id === KOSTELEC_ID)
                    .sort((a, b) => new Date(b.date) - new Date(a.date));

                if (kostelecMatches.length === 0) {
                    container.innerHTML = '<p>≈Ω√°dn√© z√°pasy nebyly nalezeny.</p>';
                    return;
                }

                container.innerHTML = kostelecMatches.map(m => {
                    const hTeam = teamsMap[m.home_id] || { title: m.home_id, logo: "logo-sk-kostelec.png" };
                    const aTeam = teamsMap[m.away_id] || { title: m.away_id, logo: "logo-sk-kostelec.png" };
                    const d = new Date(m.date);
                    
                    // Logika barev sk√≥re pro Kostelec
                    let resultClass = '';
                    if (m.played) {
                        const isHome = m.home_id === KOSTELEC_ID;
                        const scoreHome = parseInt(m.home_score);
                        const scoreAway = parseInt(m.away_score);
                        
                        if (scoreHome === scoreAway) resultClass = ''; // rem√≠za
                        else if (scoreHome > scoreAway) resultClass = isHome ? 'win' : 'loss';
                        else resultClass = isHome ? 'loss' : 'win';
                    }

                    return `
                        <div class="match-row ${!m.played ? 'upcoming' : ''}">
                            <div class="match-meta">
                                <span class="m-date">${d.toLocaleDateString('cs-CZ')} ${!m.played ? '| ' + d.toLocaleTimeString('cs-CZ', {hour: '2-digit', minute:'2-digit'}) : ''}</span>
                                <span class="m-badge">${!m.played ? 'P≈ò√ç≈†T√ç' : 'V√ùSLEDEK'}</span>
                            </div>
                            <div class="match-main">
                                <div class="m-team home">
                                    <span class="team-name">${hTeam.title}</span>
                                    <img src="${hTeam.logo}" class="m-logo">
                                </div>
                                <div class="m-score ${resultClass}">
                                    ${m.played ? `${m.home_score}:${m.away_score}` : 'VS'}
                                </div>
                                <div class="m-team away">
                                    <img src="${aTeam.logo}" class="m-logo">
                                    <span class="team-name">${aTeam.title}</span>
                                </div>
                            </div>
                            ${m.played && m.half_home !== undefined ? `<div style="text-align:center; font-size:0.8rem; color:#777; margin-bottom:10px;">Poloƒças (${m.half_home}:${m.half_away})</div>` : ''}
                            ${m.scorers && m.scorers.length > 0 ? `<div class="m-scorers">‚öΩ St≈ôelci: ${m.scorers.join(', ')}</div>` : ''}
                        </div>
                    `;
                }).join('');

            } catch(e) {
                console.error(e);
                container.innerHTML = '<p>Chyba p≈ôi naƒç√≠t√°n√≠ dat.</p>';
            }
        }

        initMatches();

        // UI Funkce (Menu)
        const menuToggle = document.querySelector('.menu-toggle');
        const navLinks = document.querySelector('.nav-links');
        if (menuToggle) {
            menuToggle.addEventListener('click', () => {
                menuToggle.classList.toggle('active');
                navLinks.classList.toggle('active');
            });
        }

        // Back to top
        const btt = document.getElementById("backToTop");
        window.onscroll = function() {
            if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) { btt.style.display = "block"; } else { btt.style.display = "none"; }
        };
        btt.onclick = function() { window.scrollTo({ top: 0, behavior: 'smooth' }); };
    </script>
</body>
</html>