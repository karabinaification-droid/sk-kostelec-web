<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SK Kostelec nad Černými lesy | Oficiální stránky</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>

    <header>
        <nav class="navbar">
            <div class="logo-container">
                <img src="logo-sk-kostelec.png" alt="Logo SK Kostelec" class="main-logo">
            </div>
            <ul class="nav-links">
                <li><a href="#">Aktuality</a></li>
                <li><a href="#">Týmy</a></li>
                <li><a href="#">Zápasy</a></li>
                <li><a href="#">Klub</a></li>
                <li><a href="#">Kontakt</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="news-hero">
            <div class="news-card main-news" style="background-image: url('https://via.placeholder.com/800x600?text=Hlavni+zpravy');">
                <div class="overlay">
                    <span class="category">A-Tým</span>
                    <h2>SK Kostelec hlásí novou posilu do útoku</h2>
                </div>
            </div>
            <div class="news-card sub-news" style="background-image: url('https://via.placeholder.com/400x300?text=Mladez');">
                <div class="overlay">
                    <span class="category">Mládež</span>
                    <h3>Nábor dětí do fotbalové školičky</h3>
                </div>
            </div>
            <div class="news-card sub-news" style="background-image: url('https://via.placeholder.com/400x300?text=Klub');">
                <div class="overlay">
                    <span class="category">Klub</span>
                    <h3>Brigáda na stadionu již tuto sobotu</h3>
                </div>
            </div>
        </section>

        <section class="next-match-bar">
            <div class="container">
                <div class="match-info">
                    <span class="match-label">Příští zápas:</span>
                    <span class="match-teams">SK Kostelec n. Č. l. <strong>vs.</strong> TJ Tatran Sedlčany</span>
                    <span class="match-date">22. 2. 2026 | 14:30</span>
                </div>
                <a href="#" class="btn-yellow">Všechny zápasy</a>
            </div>
        </section>

        <div class="main-content container">
            <section class="articles">
                <h2 class="section-title">Nejnovější články</h2>
                
                <div id="news-feed">
                    <p>Načítám čerstvé novinky z hřiště...</p>
                </div>
            </section>

            <aside class="sidebar">
                <h2 class="section-title">Tabulka A-Třída</h2>
                <div class="table-wrapper">
                    <table class="league-table">
                        <thead>
                            <tr><th>#</th><th>Tým</th><th>Z</th><th>B</th></tr>
                        </thead>
                        <tbody>
                            <tr class="highlight"><td>1.</td><td>SK Kostelec</td><td>14</td><td>32</td></tr>
                            <tr><td>2.</td><td>SK Úvaly</td><td>14</td><td>30</td></tr>
                            <tr><td>3.</td><td>Sokol Mnichovice</td><td>14</td><td>28</td></tr>
                            <tr><td>4.</td><td>FC Jevany</td><td>14</td><td>25</td></tr>
                        </tbody>
                    </table>
                </div>
                <a href="https://www.fotbal.cz/souteze/turnaje/hlavni/12d1eb58-8f55-487d-8a25-2eb1758b70c8" class="full-table-link" target="_blank">Celá tabulka na fotbal.cz</a>
            </aside>
        </div>
    </main>

    <footer class="main-footer">
        <div class="container footer-grid">
            <div class="footer-col">
                <img src="logo-sk-kostelec.png" alt="Logo SK Kostelec" class="footer-logo">
                <p><strong>SK Kostelec nad Černými lesy</strong></p>
                <p>V Olšinách 123<br>Kostelec n. Č. l.</p>
            </div>
            <div class="footer-col">
                <h4>Odkazy</h4>
                <ul>
                    <li><a href="#">Soupiska A-Týmu</a></li>
                    <li><a href="#">Rozpis zápasů</a></li>
                    <li><a href="#">Mládežnické týmy</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Sledujte nás</h4>
                <p>Facebook | Instagram</p>
                <div class="partner-logos">
                    <div class="p-box">FAČR</div>
                    <div class="p-box">Město</div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 SK Kostelec nad Černými lesy. Vytvořeno v rámci modernizace klubu.</p>
        </div>
    </footer>

    <script>
      if (window.netlifyIdentity) {
        window.netlifyIdentity.on("init", user => {
          if (!user) {
            window.netlifyIdentity.on("login", () => {
              document.location.href = "/admin/";
            });
          }
        });
      }
    </script>

    <script>
      async function loadNews() {
        const feed = document.getElementById('news-feed');
        try {
          // Načtení seznamu souborů ze složky _posts na tvém GitHubu
          const response = await fetch('https://api.github.com/repos/karabinaification-droid/sk-kostelec-web/contents/_posts');
          const files = await response.json();
          
          if (!files || files.length === 0) {
            feed.innerHTML = '<p>Zatím nebyly přidány žádné aktuality.</p>';
            return;
          }

          feed.innerHTML = ''; // Vymazat načítací text

          // Projdeme soubory od nejnovějšího (reverse)
          for (const file of files.reverse()) {
            const res = await fetch(file.download_url);
            const content = await res.text();
            
            // Rozdělení souboru (YAML hlavička vs text)
            const parts = content.split('---');
            const meta = parts[1];
            const body = parts[2];
            
            // Vytažení dat pomocí regulárních výrazů
            const titleMatch = meta.match(/title: "(.*)"/);
            const dateMatch = meta.match(/date: (.*)/);
            const imgMatch = meta.match(/image: (.*)/);
            
            const title = titleMatch ? titleMatch[1] : 'Bez názvu';
            const date = dateMatch ? new Date(dateMatch[1]).toLocaleDateString('cs-CZ') : '';
            const img = imgMatch ? imgMatch[1].replace(/"/g, '') : 'https://via.placeholder.com/150';

            // Vygenerování HTML pro každý článek
            feed.innerHTML += `
              <article class="article-row">
                <div class="art-img" style="background-image: url('${img}');"></div>
                <div class="art-text">
                    <span class="date">${date}</span>
                    <h3>${title}</h3>
                    <p>${marked.parse(body.substring(0, 160))}...</p>
                </div>
              </article>
            `;
          }
        } catch (e) {
          console.error(e);
          feed.innerHTML = '<p>Nepodařilo se načíst články. Zkontrolujte prosím připojení.</p>';
        }
      }
      // Spuštění funkce po načtení stránky
      loadNews();
    </script>

</body>
</html>